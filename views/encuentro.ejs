<%- include('partials/head') %>

<main>
  <div class="max-w-md mx-auto p-4">
    <div class="grid grid-cols-3 items-center mb-4">
      <div class="flex flex-col items-center justify-self-start">
        <img src="<%= partido.local.logo %>" class="w-10 h-10 mb-1">
        <span class="text-xs text-center max-w-[80px] line-clamp-2"><%= partido.local.nombre %></span>
      </div>
      
      <div class="text-center justify-self-center">
        <div class="text-2xl font-bold"><%= partido.ftScore %></div>
        <div class="text-sm text-gray-400">HT: <%= partido.htScore %></div>
      </div>
      
      <div class="flex flex-col items-center justify-self-end">
        <img src="<%= partido.visitante.logo %>" class="w-10 h-10 mb-1">
        <span class="text-xs text-center max-w-[80px] line-clamp-2"><%= partido.visitante.nombre %></span>
      </div>
    </div>

    <!-- Estadísticas -->
    <div class="bg-gray-800 rounded-xl p-3 space-y-3 mb-5">
      <div class="flex justify-between text-sm">
        <span><%= partido.estadisticas.posesion.local %>%</span>
        <span class="text-gray-400">Posesión</span>
        <span><%= partido.estadisticas.posesion.visitante %>%</span>
      </div>
      <div class="flex justify-between text-sm">
        <span><%= partido.estadisticas.rematesTotales.local %></span>
        <span class="text-gray-400">Remates Totales</span>
        <span><%= partido.estadisticas.rematesTotales.visitante %></span>
      </div>
      <div class="flex justify-between text-sm">
        <span><%= partido.estadisticas.rematesPuerta.local %></span>
        <span class="text-gray-400">Remates a Puerta</span>
        <span><%= partido.estadisticas.rematesPuerta.visitante %></span>
      </div>
      <div class="flex justify-between text-sm">
        <span><%= partido.estadisticas.corners.local %></span>
        <span class="text-gray-400">Corners</span>
        <span><%= partido.estadisticas.corners.visitante %></span>
      </div>
      <div class="flex justify-between text-sm">
        <span><%= partido.estadisticas.faltas.local %></span>
        <span class="text-gray-400">Faltas</span>
        <span><%= partido.estadisticas.faltas.visitante %></span>
      </div>
      <div class="flex justify-between text-sm">
        <span><%= partido.estadisticas.sustituciones.local %></span>
        <span class="text-gray-400">Sustituciones</span>
        <span><%= partido.estadisticas.sustituciones.visitante %></span>
      </div>
      <div class="flex justify-between text-sm">
        <span class="text-yellow-400"><%= partido.estadisticas.amarillas.local %></span>
        <span class="text-gray-400">Amarillas</span>
        <span class="text-yellow-400"><%= partido.estadisticas.amarillas.visitante %></span>
      </div>
      <div class="flex justify-between text-sm">
        <span class="text-red-500"><%= partido.estadisticas.rojas.local %></span>
        <span class="text-gray-400">Rojas</span>
        <span class="text-red-500"><%= partido.estadisticas.rojas.visitante %></span>
      </div>
    </div>

    <!-- Línea de Tiempo -->
    <div class="bg-gray-800 rounded-xl p-3">
      <h2 class="text-lg font-semibold mb-3 text-center">Eventos</h2>
      <div class="relative">
        <div class="space-y-6">
          <% partido.eventos.forEach(ev => { %>
            <div class="grid grid-cols-3 items-center">
              <% if (ev.equipo === 'local') { %>
                <div class="text-left pr-3 text-xs max-w-[200px] break-words">
                  <% if (ev.tipo === 'goal' || ev.tipo === 'own-goal' || ev.tipo === 'penalty') { %>
                    <div class="flex items-center gap-2">
                      <%- include('partials/ball', {
                        color: ev.tipo === 'own-goal' ? 'text-red-400' : ev.tipo === 'penalty' ? 'text-red-200' : 'text-green-400'
                      }) %>
                      <span class="whitespace-normal"><%= ev.jugador %></span>
                    </div>
                  <% } else if (ev.tipo === 'yellowcard') { %>
                    <div class="flex items-center gap-2">
                      <span class="inline-block w-3 h-4 bg-yellow-400 rounded-sm"></span>
                      <span class="whitespace-normal"><%= ev.jugador %></span>
                    </div>
                  <% } else if (ev.tipo === 'redcard') { %>
                    <div class="flex items-center gap-2">
                      <span class="inline-block w-3 h-4 bg-red-500 rounded-sm"></span>
                      <span class="whitespace-normal"><%= ev.jugador %></span>
                    </div>
                  <% } else if (ev.tipo === 'substitution') { %>
                    <div class="flex items-center gap-2">
                      <%- include('partials/arrow') %>
                      <div class="flex flex-col leading-tight">
                        <span class="text-emerald-400 whitespace-normal"><%= ev.jugador %></span>
                        <span class="text-red-400 whitespace-normal"><%= ev.jugadorSale %></span>
                      </div>
                    </div>
                  <% } else if (ev.tipo === 'var') { %>
                    <div class="flex items-center gap-2">
                      <span class="inline-block w-4 h-4 align-middle">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M7 21L12 17L17 21M7.8 17H16.2C17.8802 17 18.7202 17 19.362 16.673C19.9265 16.3854 20.3854 15.9265 20.673 15.362C21 14.7202 21 13.8802 21 12.2V7.8C21 6.11984 21 5.27976 20.673 4.63803C20.3854 4.07354 19.9265 3.6146 19.362 3.32698C18.7202 3 17.8802 3 16.2 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V12.2C3 13.8802 3 14.7202 3.32698 15.362C3.6146 15.9265 4.07354 16.3854 4.63803 16.673C5.27976 17 6.11984 17 7.8 17Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                      </span>
                      <div class="flex flex-col leading-tight">
                        <span class="text-emerald-400 whitespace-normal"><%= ev.jugador %></span>
                        <span class="text-red-400 whitespace-normal"><%= ev.varResult === 'Goal awarded' ? 'Gol Concedido' : ev.varResult === 'Penalty awarded' ? 'Penalti Concedido' : ev.varResult %></span>
                      </div>
                    </div>
                  <% } %>
                </div>
                <div class="flex flex-col items-center justify-center text-xs text-gray-400">
                  <div class="mb-1">
                    <%= ev.minuto %>'<%= ev.extraMinute ? '+' + ev.extraMinute : '' %>
                  </div>
                </div>
                <div></div>
              <% } else { %>
                <div></div>
                <div class="flex flex-col items-center justify-center text-xs text-gray-400">
                  <div class="mb-1">
                    <%= ev.minuto %>'<%= ev.extraMinute ? '+' + ev.extraMinute : '' %>
                  </div>
                </div>
                <div class="text-right text-xs max-w-[200px] break-words">
                  <% if (ev.tipo === 'goal' || ev.tipo === 'own-goal' || ev.tipo === 'penalty') { %>
                    <div class="flex items-center gap-2 justify-end">
                      <span class="whitespace-normal"><%= ev.jugador %></span>
                      <%- include('partials/ball', {
                        color: ev.tipo === 'own-goal' ? 'text-red-400' : ev.tipo === 'penalty' ? 'text-red-200' : 'text-green-400'
                      }) %>
                    </div>
                  <% } else if (ev.tipo === 'yellowcard') { %>
                    <div class="flex items-center gap-2 justify-end">
                      <span class="whitespace-normal"><%= ev.jugador %></span>
                      <span class="inline-block w-3 h-4 bg-yellow-400 rounded-sm"></span>
                    </div>
                  <% } else if (ev.tipo === 'redcard') { %>
                    <div class="flex items-center gap-2 justify-end">
                      <span class="whitespace-normal"><%= ev.jugador %></span>
                      <span class="inline-block w-3 h-4 bg-red-500 rounded-sm"></span>
                    </div>
                  <% } else if (ev.tipo === 'substitution') { %>
                    <div class="flex items-center gap-2 justify-end">
                      <div class="flex flex-col leading-tight text-right">
                        <span class="text-emerald-400 whitespace-normal"><%= ev.jugador %></span>
                        <span class="text-red-400 whitespace-normal"><%= ev.jugadorSale %></span>
                      </div>
                      <%- include('partials/arrow') %>
                    </div>
                  <% } else if (ev.tipo === 'var') { %>
                    <div class="flex items-center gap-2 justify-end">
                      <div class="flex flex-col leading-tight text-right">
                        <span class="text-emerald-400 whitespace-normal"><%= ev.jugador %></span>
                        <span class="text-red-400 whitespace-normal"><%= ev.varResult === 'Goal awarded' ? 'Gol Concedido' : ev.varResult %></span>
                      </div>
                      <span class="inline-block w-4 h-4 align-middle">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M7 21L12 17L17 21M7.8 17H16.2C17.8802 17 18.7202 17 19.362 16.673C19.9265 16.3854 20.3854 15.9265 20.673 15.362C21 14.7202 21 13.8802 21 12.2V7.8C21 6.11984 21 5.27976 20.673 4.63803C20.3854 4.07354 19.9265 3.6146 19.362 3.32698C18.7202 3 17.8802 3 16.2 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V12.2C3 13.8802 3 14.7202 3.32698 15.362C3.6146 15.9265 4.07354 16.3854 4.63803 16.673C5.27976 17 6.11984 17 7.8 17Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                      </span>
                    </div>
                  <% } %>
                </div>
              <% } %>
            </div>
          <% }) %>
        </div>
      </div>
    </div>
  </div>
</main>

<%- include('partials/footer') %>